{"version":3,"file":"index.js","sources":["../src/js/home.js"],"sourcesContent":["import { getTrending, getUpcoming, convertGenreIdsToNames } from './API.js';\nimport { openDetailsModal } from './hero_modals.js';\n\nconst renderStars = rating => {\n  const totalStars = 5;\n  const roundedRating = Math.round(rating * 2) / 2;\n\n  const fullStars = Math.floor(roundedRating);\n  const halfStar = roundedRating % 1 === 0.5 ? 1 : 0;\n  const emptyStars = totalStars - fullStars - halfStar;\n\n  let starHTML = '';\n\n  for (let i = 0; i < fullStars; i++) {\n    starHTML += `<svg class=\"icon\"><use xlink:href=\"#icon-star\"></use></svg>`;\n  }\n  if (halfStar) {\n    starHTML += `<svg class=\"icon\"><use xlink:href=\"#icon-star-half\"></use></svg>`;\n  }\n  for (let i = 0; i < emptyStars; i++) {\n    starHTML += `<svg class=\"icon\"><use xlink:href=\"#icon-star-empty\"></use></svg>`;\n  }\n\n  return starHTML;\n};\n\nconst renderTrendingMovies = async () => {\n  try {\n    const trendingData = await getTrending('week');\n    const trendingMovies = trendingData.results;\n\n    const trendingContainer = document.querySelector('#trending-container');\n\n    const numberOfCards = window.innerWidth < 768 ? 1 : 3;\n\n    trendingContainer.innerHTML = '';\n\n    for (const movie of trendingMovies.slice(0, numberOfCards)) {\n      const genreNames = await convertGenreIdsToNames(movie.genre_ids);\n      const limitedGenreNames = genreNames.slice(0, 2);\n      const genreText = limitedGenreNames.join(', ');\n\n      const movieElement = document.createElement('div');\n      movieElement.classList.add('trending-card');\n      movieElement.setAttribute('data-movie-id', movie.id);\n\n      const posterUrl = movie.poster_path\n        ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n        : `https://image.tmdb.org/t/p/w500${movie.backdrop_path}`;\n\n      movieElement.innerHTML = `\n        <img src=\"${posterUrl}\" alt=\"${movie.title}\">\n        <h3>${movie.title.toUpperCase()}</h3>\n        <p>${genreText} | ${new Date(\n        movie.release_date\n      ).getFullYear()} ${renderStars(movie.vote_average / 2)}</p>\n      `;\n\n      movieElement.style.backgroundImage = `url('https://image.tmdb.org/t/p/original${movie.backdrop_path}')`;\n\n      movieElement.innerHTML = `\n  <div class=\"card-info\">\n    <h3>${movie.title.toUpperCase()}</h3>\n    <div class=\"card-info-inner\">\n      <div class=\"card-info-left\">\n        <p class=\"card-info-p\">${genreText} | ${new Date(\n        movie.release_date\n      ).getFullYear()}</p>\n      </div>\n      <div class=\"card-info-right\">\n        ${renderStars(movie.vote_average / 2)}\n      </div>\n    </div>\n  </div>\n`;\n\n      movieElement.addEventListener('click', async () => {\n        const movieDetails = {\n          ...movie,\n          genres: genreNames.map(name => ({ name })),\n        };\n        openDetailsModal(movieDetails);\n      });\n\n      trendingContainer.appendChild(movieElement);\n    }\n  } catch (error) {\n    console.error('Error fetching trending movies:', error);\n  }\n};\n\nconst isMovieInLibrary = movieId => {\n  const library = JSON.parse(localStorage.getItem('myLibrary')) || [];\n  return library.some(movie => movie.id === movieId);\n};\n\nconst addMovieToLibrary = movie => {\n  const library = JSON.parse(localStorage.getItem('myLibrary')) || [];\n  const movieToAdd = {\n    id: movie.id,\n    title: movie.title,\n    poster: `https://image.tmdb.org/t/p/w500${movie.poster_path}`,\n    backdrop_path: movie.backdrop_path,\n    release_date: movie.release_date,\n    vote_average: movie.vote_average,\n    vote_count: movie.vote_count,\n    popularity: movie.popularity,\n    overview: movie.overview,\n    genre_ids: movie.genre_ids,\n  };\n  library.push(movieToAdd);\n  localStorage.setItem('myLibrary', JSON.stringify(library));\n};\n\nconst removeMovieFromLibrary = movieId => {\n  let library = JSON.parse(localStorage.getItem('myLibrary')) || [];\n  library = library.filter(movie => movie.id !== movieId);\n  localStorage.setItem('myLibrary', JSON.stringify(library));\n};\n\nconst handleLibraryToggle = (movie, button) => {\n  const movieWithFullPoster = {\n    ...movie,\n    poster: `https://image.tmdb.org/t/p/w500${movie.poster_path}`,\n  };\n\n  if (isMovieInLibrary(movieWithFullPoster.id)) {\n    removeMovieFromLibrary(movieWithFullPoster.id);\n    button.textContent = 'Add to my library';\n  } else {\n    addMovieToLibrary(movieWithFullPoster);\n    button.textContent = 'Remove from my library';\n  }\n};\n\nconst renderUpcomingMovie = async () => {\n  try {\n    const upcomingData = await getUpcoming();\n    const upcomingMovies = upcomingData.results;\n    const movie = upcomingMovies[Math.floor(Math.random() * 10)];\n    console.log(movie);\n\n    const genreNames = await convertGenreIdsToNames(movie.genre_ids);\n    const genreText = genreNames.join(', ');\n\n    document.getElementById(\n      'upcoming-movie-poster'\n    ).src = `https://image.tmdb.org/t/p/w500${movie.backdrop_path}`;\n    document.getElementById('upcoming-movie-title').textContent = movie.title;\n    document.getElementById('upcoming-release-date').textContent =\n      movie.release_date;\n\n    document.querySelector('.vote-average').textContent =\n      movie.vote_average.toFixed(1);\n    document.querySelector('.vote-count').textContent = movie.vote_count;\n\n    document.getElementById('upcoming-popularity').textContent =\n      movie.popularity.toFixed(1);\n    document.getElementById('upcoming-overview').textContent = movie.overview;\n    document.getElementById('upcoming-genre').textContent = genreText;\n\n    const addLibraryButton = document.getElementById('add-library-button');\n    addLibraryButton.textContent = isMovieInLibrary(movie.id)\n      ? 'Remove from my library'\n      : 'Add to my library';\n\n    addLibraryButton.addEventListener('click', event => {\n      const movieToAdd = {\n        title: movie.title,\n        vote_average: movie.vote_average,\n        vote_count: movie.vote_count,\n        popularity: movie.popularity,\n        genres: movie.genre_ids.map(genre => genre.name),\n        overview: movie.overview,\n        year: new Date(movie.release_date).getFullYear(),\n        poster: `https://image.tmdb.org/t/p/w500${movie.poster_path}`,\n      };\n\n      // Sprawdź, czy film jest już w bibliotece\n      const myLibrary = JSON.parse(localStorage.getItem('myLibrary')) || [];\n      const movieExists = myLibrary.some(\n        item => item.title === movieToAdd.title\n      );\n\n      if (!movieExists) {\n        addMovieToLibrary(movieToAdd);\n        addLibraryButton.textContent = 'Remove from my library'; // Zmień tekst przycisku\n      } else {\n        removeMovieFromLibrary(movieToAdd.title);\n        addLibraryButton.textContent = 'Add to my library'; // Zmień tekst przycisku\n      }\n    });\n\n    // Funkcja dodawania filmu do localStorage\n    function addMovieToLibrary(movie) {\n      const myLibrary = JSON.parse(localStorage.getItem('myLibrary')) || [];\n      myLibrary.push(movie);\n      localStorage.setItem('myLibrary', JSON.stringify(myLibrary));\n      alert(`${movie.title} has been added to your library!`); // Użycie alertu\n    }\n\n    // Funkcja usuwania filmu z localStorage\n    function removeMovieFromLibrary(movieTitle) {\n      let myLibrary = JSON.parse(localStorage.getItem('myLibrary')) || [];\n      myLibrary = myLibrary.filter(movie => movie.title !== movieTitle);\n      localStorage.setItem('myLibrary', JSON.stringify(myLibrary));\n      alert(`${movieTitle} has been removed from your library!`); // Użycie alertu\n    }\n\n    // Inicjalizacja przycisku na podstawie obecności filmu w localStorage\n    function initializeLibraryButton(film) {\n      const myLibrary = JSON.parse(localStorage.getItem('myLibrary')) || [];\n      const movieExists = myLibrary.some(mov => mov.title === movie.title);\n\n      if (movieExists) {\n        addLibraryButton.textContent = 'Remove from My Library';\n      } else {\n        addLibraryButton.textContent = 'Add to my Library';\n      }\n    }\n\n    initializeLibraryButton(movie);\n  } catch (error) {\n    console.error('Error fetching upcoming movies:', error);\n    document.getElementById('upcoming-no-movies-message').style.display =\n      'block';\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  renderTrendingMovies();\n  renderUpcomingMovie();\n  window.addEventListener('resize', renderTrendingMovies);\n});\n"],"names":["renderStars","rating","roundedRating","fullStars","halfStar","emptyStars","starHTML","i","renderTrendingMovies","trendingMovies","getTrending","trendingContainer","numberOfCards","movie","genreNames","convertGenreIdsToNames","genreText","movieElement","posterUrl","movieDetails","name","openDetailsModal","error","isMovieInLibrary","movieId","renderUpcomingMovie","addMovieToLibrary","myLibrary","removeMovieFromLibrary","movieTitle","initializeLibraryButton","film","mov","addLibraryButton","getUpcoming","event","movieToAdd","genre","item"],"mappings":"2IAGA,MAAMA,EAAcC,GAAU,CAE5B,MAAMC,EAAgB,KAAK,MAAMD,EAAS,CAAC,EAAI,EAEzCE,EAAY,KAAK,MAAMD,CAAa,EACpCE,EAAWF,EAAgB,IAAM,GAAM,EAAI,EAC3CG,EAAa,EAAaF,EAAYC,EAE5C,IAAIE,EAAW,GAEf,QAASC,EAAI,EAAGA,EAAIJ,EAAWI,IAC7BD,GAAY,8DAEVF,IACFE,GAAY,oEAEd,QAASC,EAAI,EAAGA,EAAIF,EAAYE,IAC9BD,GAAY,oEAGd,OAAOA,CACT,EAEME,EAAuB,SAAY,CACvC,GAAI,CAEF,MAAMC,GADe,MAAMC,EAAY,MAAM,GACT,QAE9BC,EAAoB,SAAS,cAAc,qBAAqB,EAEhEC,EAAgB,OAAO,WAAa,IAAM,EAAI,EAEpDD,EAAkB,UAAY,GAE9B,UAAWE,KAASJ,EAAe,MAAM,EAAGG,CAAa,EAAG,CAC1D,MAAME,EAAa,MAAMC,EAAuBF,EAAM,SAAS,EAEzDG,EADoBF,EAAW,MAAM,EAAG,CAAC,EACX,KAAK,IAAI,EAEvCG,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,UAAU,IAAI,eAAe,EAC1CA,EAAa,aAAa,gBAAiBJ,EAAM,EAAE,EAEnD,MAAMK,EAAYL,EAAM,YACpB,kCAAkCA,EAAM,WAAW,GACnD,kCAAkCA,EAAM,aAAa,GAEzDI,EAAa,UAAY;AAAA,oBACXC,CAAS,UAAUL,EAAM,KAAK;AAAA,cACpCA,EAAM,MAAM,aAAa;AAAA,aAC1BG,CAAS,MAAM,IAAI,KACxBH,EAAM,YACd,EAAQ,YAAa,CAAA,IAAIb,EAAYa,EAAM,aAAe,CAAC,CAAC;AAAA,QAGtDI,EAAa,MAAM,gBAAkB,2CAA2CJ,EAAM,aAAa,KAEnGI,EAAa,UAAY;AAAA;AAAA,UAErBJ,EAAM,MAAM,aAAa;AAAA;AAAA;AAAA,iCAGFG,CAAS,MAAM,IAAI,KAC5CH,EAAM,YACP,EAAC,YAAW,CAAE;AAAA;AAAA;AAAA,UAGXb,EAAYa,EAAM,aAAe,CAAC,CAAC;AAAA;AAAA;AAAA;AAAA,EAMvCI,EAAa,iBAAiB,QAAS,SAAY,CACjD,MAAME,EAAe,CACnB,GAAGN,EACH,OAAQC,EAAW,IAAIM,IAAS,CAAE,KAAAA,CAAM,EAAC,CACnD,EACQC,EAAiBF,CAAY,CACrC,CAAO,EAEDR,EAAkB,YAAYM,CAAY,CAC3C,CACF,OAAQK,EAAO,CACd,QAAQ,MAAM,kCAAmCA,CAAK,CACvD,CACH,EAEMC,EAAmBC,IACP,KAAK,MAAM,aAAa,QAAQ,WAAW,CAAC,GAAK,IAClD,KAAKX,GAASA,EAAM,KAAOW,CAAO,EA0C7CC,EAAsB,SAAY,CACtC,GAAI,CA0DF,IAASC,EAAT,SAA2Bb,EAAO,CAChC,MAAMc,EAAY,KAAK,MAAM,aAAa,QAAQ,WAAW,CAAC,GAAK,GACnEA,EAAU,KAAKd,CAAK,EACpB,aAAa,QAAQ,YAAa,KAAK,UAAUc,CAAS,CAAC,EAC3D,MAAM,GAAGd,EAAM,KAAK,kCAAkC,CACvD,EAGQe,EAAT,SAAgCC,EAAY,CAC1C,IAAIF,EAAY,KAAK,MAAM,aAAa,QAAQ,WAAW,CAAC,GAAK,GACjEA,EAAYA,EAAU,OAAOd,GAASA,EAAM,QAAUgB,CAAU,EAChE,aAAa,QAAQ,YAAa,KAAK,UAAUF,CAAS,CAAC,EAC3D,MAAM,GAAGE,CAAU,sCAAsC,CAC1D,EAGQC,EAAT,SAAiCC,EAAM,EACnB,KAAK,MAAM,aAAa,QAAQ,WAAW,CAAC,GAAK,IACrC,KAAKC,GAAOA,EAAI,QAAUnB,EAAM,KAAK,EAGjEoB,EAAiB,YAAc,yBAE/BA,EAAiB,YAAc,mBAElC,EAhFD,MAAMpB,GAFe,MAAMqB,KACS,QACP,KAAK,MAAM,KAAK,OAAM,EAAK,EAAE,CAAC,EAC3D,QAAQ,IAAIrB,CAAK,EAGjB,MAAMG,GADa,MAAMD,EAAuBF,EAAM,SAAS,GAClC,KAAK,IAAI,EAEtC,SAAS,eACP,uBACD,EAAC,IAAM,kCAAkCA,EAAM,aAAa,GAC7D,SAAS,eAAe,sBAAsB,EAAE,YAAcA,EAAM,MACpE,SAAS,eAAe,uBAAuB,EAAE,YAC/CA,EAAM,aAER,SAAS,cAAc,eAAe,EAAE,YACtCA,EAAM,aAAa,QAAQ,CAAC,EAC9B,SAAS,cAAc,aAAa,EAAE,YAAcA,EAAM,WAE1D,SAAS,eAAe,qBAAqB,EAAE,YAC7CA,EAAM,WAAW,QAAQ,CAAC,EAC5B,SAAS,eAAe,mBAAmB,EAAE,YAAcA,EAAM,SACjE,SAAS,eAAe,gBAAgB,EAAE,YAAcG,EAExD,MAAMiB,EAAmB,SAAS,eAAe,oBAAoB,EACrEA,EAAiB,YAAcV,EAAiBV,EAAM,EAAE,EACpD,yBACA,oBAEJoB,EAAiB,iBAAiB,QAASE,GAAS,CAClD,MAAMC,EAAa,CACjB,MAAOvB,EAAM,MACb,aAAcA,EAAM,aACpB,WAAYA,EAAM,WAClB,WAAYA,EAAM,WAClB,OAAQA,EAAM,UAAU,IAAIwB,GAASA,EAAM,IAAI,EAC/C,SAAUxB,EAAM,SAChB,KAAM,IAAI,KAAKA,EAAM,YAAY,EAAE,YAAa,EAChD,OAAQ,kCAAkCA,EAAM,WAAW,EACnE,GAGwB,KAAK,MAAM,aAAa,QAAQ,WAAW,CAAC,GAAK,IACrC,KAC5ByB,GAAQA,EAAK,QAAUF,EAAW,KAC1C,GAMQR,EAAuBQ,EAAW,KAAK,EACvCH,EAAiB,YAAc,sBAJ/BP,EAAkBU,CAAU,EAC5BH,EAAiB,YAAc,yBAKvC,CAAK,EA8BDH,EAAwBjB,CAAK,CAC9B,OAAQS,EAAO,CACd,QAAQ,MAAM,kCAAmCA,CAAK,EACtD,SAAS,eAAe,4BAA4B,EAAE,MAAM,QAC1D,OACH,CACH,EAEA,SAAS,iBAAiB,mBAAoB,IAAM,CAClDd,IACAiB,IACA,OAAO,iBAAiB,SAAUjB,CAAoB,CACxD,CAAC"}