{"version":3,"file":"index.js","sources":["../src/js/home.js"],"sourcesContent":["import { getTrending, getUpcoming, convertGenreIdsToNames } from './API.js';\nimport { openDetailsModal } from './hero_modals.js';\n\nconst renderStars = rating => {\n  const totalStars = 5;\n  const roundedRating = Math.round(rating * 2) / 2;\n\n  const fullStars = Math.floor(roundedRating);\n  const halfStar = roundedRating % 1 === 0.5 ? 1 : 0;\n  const emptyStars = totalStars - fullStars - halfStar;\n\n  let starHTML = '';\n\n  for (let i = 0; i < fullStars; i++) {\n    starHTML += `<svg class=\"icon\"><use xlink:href=\"#icon-star\"></use></svg>`;\n  }\n  if (halfStar) {\n    starHTML += `<svg class=\"icon\"><use xlink:href=\"#icon-star-half\"></use></svg>`;\n  }\n  for (let i = 0; i < emptyStars; i++) {\n    starHTML += `<svg class=\"icon\"><use xlink:href=\"#icon-star-empty\"></use></svg>`;\n  }\n\n  return starHTML;\n};\n\nconst renderTrendingMovies = async () => {\n  try {\n    const trendingData = await getTrending('week');\n    const trendingMovies = trendingData.results;\n\n    const trendingContainer = document.querySelector('#trending-container');\n\n    const numberOfCards = window.innerWidth < 768 ? 1 : 3;\n\n    trendingContainer.innerHTML = '';\n\n    for (const movie of trendingMovies.slice(0, numberOfCards)) {\n      const genreNames = await convertGenreIdsToNames(movie.genre_ids);\n      const limitedGenreNames = genreNames.slice(0, 2);\n      const genreText = limitedGenreNames.join(', ');\n\n      const movieElement = document.createElement('div');\n      movieElement.classList.add('trending-card');\n      movieElement.setAttribute('data-movie-id', movie.id);\n\n      const posterUrl = movie.poster_path\n        ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n        : `https://image.tmdb.org/t/p/w500${movie.backdrop_path}`;\n\n      movieElement.innerHTML = `\n        <img src=\"${posterUrl}\" alt=\"${movie.title}\">\n        <h3>${movie.title.toUpperCase()}</h3>\n        <p>${genreText} | ${new Date(\n        movie.release_date\n      ).getFullYear()} ${renderStars(movie.vote_average / 2)}</p>\n      `;\n\n      movieElement.style.backgroundImage = `url('https://image.tmdb.org/t/p/original${movie.backdrop_path}')`;\n\n      movieElement.innerHTML = `\n  <div class=\"card-info\">\n    <h3>${movie.title.toUpperCase()}</h3>\n    <div class=\"card-info-inner\">\n      <div class=\"card-info-left\">\n        <p class=\"card-info-p\">${genreText} | ${new Date(\n        movie.release_date\n      ).getFullYear()}</p>\n      </div>\n      <div class=\"card-info-right\">\n        ${renderStars(movie.vote_average / 2)}\n      </div>\n    </div>\n  </div>\n`;\n\n      movieElement.addEventListener('click', async () => {\n        const movieDetails = {\n          ...movie,\n          genres: genreNames,\n        };\n        openDetailsModal(movieDetails);\n      });\n\n      trendingContainer.appendChild(movieElement);\n    }\n  } catch (error) {\n    console.error('Error fetching trending movies:', error);\n  }\n};\n\nconst isMovieInLibrary = movieId => {\n  const library = JSON.parse(localStorage.getItem('myLibrary')) || [];\n  return library.some(movie => movie.id === movieId);\n};\n\nconst addMovieToLibrary = movie => {\n  const library = JSON.parse(localStorage.getItem('myLibrary')) || [];\n  const movieToAdd = {\n    id: movie.id,\n    title: movie.title,\n    poster: `https://image.tmdb.org/t/p/w500${movie.poster_path}`,\n    backdrop_path: movie.backdrop_path,\n    release_date: movie.release_date,\n    vote_average: movie.vote_average,\n    vote_count: movie.vote_count,\n    popularity: movie.popularity,\n    overview: movie.overview,\n    genre_ids: movie.genre_ids,\n  };\n  library.push(movieToAdd);\n  localStorage.setItem('myLibrary', JSON.stringify(library));\n};\n\nconst removeMovieFromLibrary = movieId => {\n  let library = JSON.parse(localStorage.getItem('myLibrary')) || [];\n  library = library.filter(movie => movie.id !== movieId);\n  localStorage.setItem('myLibrary', JSON.stringify(library));\n};\n\nconst handleLibraryToggle = (movie, button) => {\n  const movieWithFullPoster = {\n    ...movie,\n    poster: `https://image.tmdb.org/t/p/w500${movie.poster_path}`,\n  };\n\n  if (isMovieInLibrary(movieWithFullPoster.id)) {\n    removeMovieFromLibrary(movieWithFullPoster.id);\n    button.textContent = 'Add to my library';\n  } else {\n    addMovieToLibrary(movieWithFullPoster);\n    button.textContent = 'Remove from my library';\n  }\n};\n\nconst renderUpcomingMovie = async () => {\n  try {\n    const upcomingData = await getUpcoming();\n    const upcomingMovies = upcomingData.results;\n    const movie = upcomingMovies[0];\n\n    const genreNames = await convertGenreIdsToNames(movie.genre_ids);\n    const genreText = genreNames.join(', ');\n\n    document.getElementById(\n      'upcoming-movie-poster'\n    ).src = `https://image.tmdb.org/t/p/w500${movie.backdrop_path}`;\n    document.getElementById('upcoming-movie-title').textContent = movie.title;\n    document.getElementById('upcoming-release-date').textContent =\n      movie.release_date;\n\n    document.querySelector('.vote-average').textContent =\n      movie.vote_average.toFixed(1);\n    document.querySelector('.vote-count').textContent = movie.vote_count;\n\n    document.getElementById('upcoming-popularity').textContent =\n      movie.popularity.toFixed(1);\n    document.getElementById('upcoming-overview').textContent = movie.overview;\n    document.getElementById('upcoming-genre').textContent = genreText;\n\n    const addLibraryButton = document.getElementById('add-library-button');\n    addLibraryButton.textContent = isMovieInLibrary(movie.id)\n      ? 'Remove from my library'\n      : 'Add to my library';\n\n    addLibraryButton.addEventListener('click', () =>\n      handleLibraryToggle(movie, addLibraryButton)\n    );\n  } catch (error) {\n    console.error('Error fetching upcoming movies:', error);\n    document.getElementById('upcoming-no-movies-message').style.display =\n      'block';\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  renderTrendingMovies();\n  renderUpcomingMovie();\n  window.addEventListener('resize', renderTrendingMovies);\n});\n"],"names":["renderStars","rating","roundedRating","fullStars","halfStar","emptyStars","starHTML","i","renderTrendingMovies","trendingMovies","getTrending","trendingContainer","numberOfCards","movie","genreNames","convertGenreIdsToNames","genreText","movieElement","posterUrl","movieDetails","openDetailsModal","error","isMovieInLibrary","movieId","addMovieToLibrary","library","movieToAdd","removeMovieFromLibrary","handleLibraryToggle","button","movieWithFullPoster","renderUpcomingMovie","getUpcoming","addLibraryButton"],"mappings":"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"}