{"version":3,"file":"catalog.js","sources":["../src/js/card_creator.js","../src/js/catalog.js"],"sourcesContent":["import { convertGenreIdsToNames } from './API.js';\nimport { displayStarRating } from './hero.js';\n\nexport const element = (tag, props) =>\n  Object.assign(document.createElement(tag), props);\n\nexport const createElement = ({\n  poster_path,\n  title,\n  genre_ids,\n  release_date,\n  vote_average,\n}) => {\n  const card = element('li', { className: 'catalog-card' });\n\n  const poster = element('img', {\n    className: 'catalog-card-poster',\n    src: `https://image.tmdb.org/t/p/original/${poster_path}`,\n  });\n\n  const description = element('div', {\n    className: 'catalog-card-description',\n  });\n\n  const filmTitle = element('p', {\n    className: 'catalog-card-title',\n    textContent: title.toUpperCase(),\n  });\n  const descriptionSub = element('div', {\n    className: 'catalog-card-description-sub',\n  });\n\n  const genres = element('p', {\n    className: 'catalog-card-description-element',\n  });\n  convertGenreIdsToNames(genre_ids).then(genreNames => {\n    genres.textContent = `${genreNames\n      .slice(0, 2)\n      .join(', ')} | ${release_date.slice(0, 4)}`;\n  });\n\n  const descriptionSubSub = element('div', {\n    className: 'catalog-card-description-sub-sub',\n  });\n  const stars = element('p', {\n    className: 'catalog-star-rating',\n    innerHTML: displayStarRating(vote_average),\n  });\n\n  descriptionSub.append(genres);\n  descriptionSubSub.append(descriptionSub, stars);\n  description.append(filmTitle, descriptionSubSub);\n  card.append(poster, description);\n  return card;\n};\n","import { getTrending, getDetails } from './API.js';\nimport { element, createElement } from './card_creator.js';\nimport { openDetailsModal } from './hero_modals.js';\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst catalog = document.querySelector('.catalog');\nconst form = document.querySelector('#searchForm');\nconst filmList = document.querySelector('#film-list');\nconst input = document.querySelector('#searchForm-input');\nconst inputClear = document.querySelector('#searchForm-input-clear');\nconst pagination = document.querySelector('#pagination');\n\ninputClear.style.display = 'none';\n\nlet currentPage = 1;\nconst API_KEY =\n  'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2Y2IxMWQ4ZGE0NTZlOGI5OTIxM2EyNDk4ODM4OGQyNSIsIm5iZiI6MTcyODcyMDEzMC44MDY0Niwic3ViIjoiNjcwYTJiNDEzYmI0NTU3YzY2OWFmYzM5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.Pgojbxf9JKo_J1qf6Qmglon5qZgkr9wpZ4I978dGQU8';\naxios.defaults.baseURL = 'https://api.themoviedb.org/3';\naxios.defaults.headers.common['Authorization'] = API_KEY;\n\nconst renderElements = (films, rootList, callback) => {\n  const fragment = document.createDocumentFragment();\n  fragment.append(\n    ...films.map(film => {\n      const filmElement = callback(film);\n\n      filmElement.addEventListener('click', async e => {\n        if (e.target.classList.contains('catalog-card')) {\n          try {\n            const details = await getDetails(film.id);\n            openDetailsModal(details);\n          } catch (error) {\n            console.log('Error fetching movie details:', error);\n          }\n        }\n      });\n\n      return filmElement;\n    })\n  );\n\n  rootList.append(fragment);\n};\n\nconst fetchTrendingMovies = async () => {\n  try {\n    const response = await getTrending('day');\n    console.log(response);\n    renderElements(response.results, filmList, createElement);\n  } catch (error) {\n    filmList.innerHTML =\n      '<h2>OOPS!</h2><p>We are very sorry! We don’t have any results matching your search.</p>';\n    console.log(error);\n  }\n};\n\nconst searchMovies = async () => {\n  try {\n    const params = new URLSearchParams({\n      query: input.value.trim(),\n      include_adult: false,\n      page: currentPage,\n    });\n    const response = await axios.get(`/search/movie?${params}`);\n    return response.data;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst search = async () => {\n  try {\n    const response = await searchMovies();\n    filmList.innerHTML = '';\n    renderElements(response.results, filmList, createElement);\n  } catch (error) {\n    console.log('Error in search:', error);\n  }\n};\n\n// Funkcja do tworzenia paginacji\nconst createPagination = async () => {\n  try {\n    const response = await searchMovies();\n    const totalPages = response.total_pages;\n    const visibleButtons = 5;\n    pagination.innerHTML = '';\n    pagination.style.display = 'flex';\n    const prevEl = element('li', { classList: 'pagination-item' });\n    const prevButton = element('button', {\n      classList: 'pagination-btn prev-page',\n      id: 'previous-page',\n      textContent: '<',\n    });\n    prevButton.addEventListener('click', () => {\n      if (currentPage > 1) {\n        currentPage--;\n        search();\n        createPagination();\n      }\n    });\n    prevEl.append(prevButton);\n    pagination.append(prevEl);\n\n    const pageList = element('ul', { classList: 'page-list' });\n    pagination.append(pageList);\n    pageList.style.display = 'flex';\n\n    let startPage = Math.max(1, currentPage - Math.floor(visibleButtons / 2));\n    let endPage = Math.min(totalPages, startPage + visibleButtons - 1);\n\n    if (endPage - startPage < visibleButtons - 1) {\n      if (startPage === 1) {\n        endPage = Math.min(totalPages, startPage + visibleButtons - 1);\n      } else {\n        startPage = Math.max(1, endPage - visibleButtons + 1);\n      }\n    }\n\n    if (startPage > 1) {\n      const firstPageButton = element('li', { classList: 'pagination-item' });\n      const firstButton = element('button', {\n        classList: 'pagination-btn',\n        textContent: '1',\n      });\n      firstButton.addEventListener('click', () => {\n        currentPage = 1;\n        search();\n        createPagination();\n      });\n      firstPageButton.append(firstButton);\n      pageList.append(firstPageButton);\n\n      if (startPage > 2) {\n        const ellipsis = element('li', {\n          classList: 'pagination-item',\n          textContent: '...',\n        });\n        pageList.append(ellipsis);\n      }\n    }\n\n    for (let i = startPage; i <= endPage; i++) {\n      const listEl = element('li', { classList: 'pagination-item' });\n      const pageButton = element('button', {\n        classList: 'pagination-btn',\n        textContent: i,\n      });\n      pageButton.addEventListener('click', () => {\n        currentPage = i;\n        search();\n        createPagination();\n      });\n      listEl.append(pageButton);\n      pageList.append(listEl);\n    }\n\n    if (endPage < totalPages) {\n      if (endPage < totalPages - 1) {\n        const ellipsis = element('li', {\n          classList: 'pagination-item',\n          textContent: '...',\n        });\n        pageList.append(ellipsis);\n      }\n\n      const lastPageButton = element('li', { classList: 'pagination-item' });\n      const lastButton = element('button', {\n        classList: 'pagination-btn',\n        textContent: totalPages,\n      });\n      lastButton.addEventListener('click', () => {\n        currentPage = totalPages;\n        search();\n        createPagination();\n      });\n      lastPageButton.append(lastButton);\n      pageList.append(lastPageButton);\n    }\n\n    const nextEl = element('li', { classList: 'pagination-item' });\n    const nextButton = element('button', {\n      classList: 'pagination-btn next-page',\n      id: 'next-page',\n      textContent: '>',\n    });\n    nextButton.addEventListener('click', () => {\n      if (currentPage < totalPages) {\n        currentPage++;\n        search();\n        createPagination();\n      }\n    });\n    nextEl.append(nextButton);\n    pagination.append(nextEl);\n\n    if (currentPage === 1) {\n      prevButton.disabled = true;\n    }\n    if (currentPage === totalPages) {\n      nextButton.disabled = true;\n    }\n    const buttons = Array.from(\n      document.querySelectorAll('.pagination-btn')\n    ).slice(1, -1);\n    buttons.forEach(button => {\n      if (button.textContent == currentPage) {\n        button.classList.add('pagination-btn-active');\n      }\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', fetchTrendingMovies);\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  if (input.value !== '') {\n    filmList.innerHTML = '';\n    pagination.innerHTML = '';\n\n    (async () => {\n      currentPage = 1;\n      await search();\n      await createPagination();\n      if (filmList.childElementCount === 0) {\n        filmList.innerHTML =\n          '<div class=\"catalog-oops\"><h2>OOPS!</h2><p>We are very sorry! We don’t have any results matching your search.</p></div>';\n        pagination.style.display = 'none';\n      }\n    })();\n    inputClear.style.display = 'inline';\n  } else {\n    iziToast.info({\n      message: 'Type film title.',\n    });\n  }\n});\n\ninputClear.addEventListener('click', e => {\n  inputClear.style.display = 'none';\n  pagination.style.display = 'none';\n  input.value = '';\n});\n"],"names":["element","tag","props","createElement","poster_path","title","genre_ids","release_date","vote_average","card","poster","description","filmTitle","descriptionSub","genres","convertGenreIdsToNames","genreNames","descriptionSubSub","stars","displayStarRating","form","filmList","input","inputClear","pagination","currentPage","API_KEY","axios","renderElements","films","rootList","callback","fragment","film","filmElement","e","details","getDetails","openDetailsModal","error","fetchTrendingMovies","response","getTrending","searchMovies","params","search","createPagination","totalPages","visibleButtons","prevEl","prevButton","pageList","startPage","endPage","firstPageButton","firstButton","ellipsis","i","listEl","pageButton","lastPageButton","lastButton","nextEl","nextButton","button","iziToast"],"mappings":"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"}